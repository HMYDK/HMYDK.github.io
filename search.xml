<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>é—®ç­”:RocketMQ</title>
      <link href="/2022/031526519.html"/>
      <url>/2022/031526519.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>åŸºäºRocketMQ v4.5.0ä¹‹å‰çš„ç‰ˆæœ¬</p></blockquote><h4 id="Qï¼šè·¯ç”±æ³¨å†Œæœºåˆ¶"><a href="#Qï¼šè·¯ç”±æ³¨å†Œæœºåˆ¶" class="headerlink" title="Qï¼šè·¯ç”±æ³¨å†Œæœºåˆ¶"></a>Qï¼šè·¯ç”±æ³¨å†Œæœºåˆ¶</h4><img src="https://cdn.jsdelivr.net/gh/HMYDK/picb@main/img/image-20220314165017030.png" alt="image-20220314165017030" style="zoom: 50%;" /><ul><li>é›†ç¾¤ä¸­æ‰€æœ‰çš„<code>Broker</code>æ¯éš”30så‘æ‰€æœ‰çš„<code>NameServer</code>å‘é€å¿ƒè·³åŒ…ï¼Œ<u>æ³¨å†ŒTopicè·¯ç”±ä¿¡æ¯</u>ã€‚</li><li><code>NameServer</code>åœ¨æ”¶åˆ°Brokerç«¯çš„å¿ƒè·³åŒ…æ—¶é¦–å…ˆä¼š<u>æ›´æ–°è·¯ç”±è¡¨ï¼Œå¹¶è®°å½•æ”¶åˆ°å¿ƒè·³åŒ…çš„æ—¶é—´</u>ã€‚</li><li><code>NameServer</code>ä¼šå¯åŠ¨ä¸€ä¸ªå®šæ—¶ä»»åŠ¡æ¯10sä¼šæ‰«æ<code>Broker</code>ï¼Œå¦‚æœ<code>NameServer</code>è¿ç»­120sæœªæ”¶åˆ°<code>Broker</code>çš„å¿ƒè·³åŒ…ï¼Œä¼šåˆ¤å®š<code>Broker</code>å·²ä¸‹çº¿ï¼Œå°†ä»è·¯ç”±è¡¨ä¸­å°†æ­¤<code>Broker</code>å‰”é™¤ã€‚</li><li>å¦‚æœ <code>Nameserver</code> ä¸ <code>Broker</code> ç«¯çš„é•¿è¿æ¥æ–­å¼€ï¼Œ<code>NameServer</code> ä¼šç«‹å³æ„ŸçŸ¥ <code>Broker</code> ä¸‹çº¿å¹¶ä»è·¯ç”±è¡¨ä¸­å°†è¯¥ <code>Broker</code> ç§»é™¤ã€‚</li><li>æ¶ˆæ¯å®¢æˆ·ç«¯(æ¶ˆæ¯å‘é€è€…ã€æ¶ˆæ¯æ¶ˆè´¹è€…)åœ¨ä»»æ„æ—¶åˆ»<u>åªä¼šå’Œå…¶ä¸­ä¸€å°</u> <code>NameServer</code> å»ºç«‹ è¿æ¥ï¼Œå¹¶æ¯éš” 30s å‘ <code>NameServer</code> æŸ¥è¯¢è·¯ç”±ä¿¡æ¯ï¼Œå¦‚æœæŸ¥è¯¢åˆ°ç»“æœä¼š<u>æ›´æ–°å‘é€è€…çš„ æœ¬åœ°è·¯ç”±ä¿¡æ¯</u>ã€‚</li></ul><h4 id="Qï¼šbrokerä¸»ä»æœåŠ¡å™¨éƒ½åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¶ˆæ¯æ¶ˆè´¹æ˜¯ä»ä¸»èŠ‚ç‚¹æ‹‰å–è¿˜æ˜¯ä»èŠ‚ç‚¹æ‹‰å–ï¼Ÿ"><a href="#Qï¼šbrokerä¸»ä»æœåŠ¡å™¨éƒ½åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¶ˆæ¯æ¶ˆè´¹æ˜¯ä»ä¸»èŠ‚ç‚¹æ‹‰å–è¿˜æ˜¯ä»èŠ‚ç‚¹æ‹‰å–ï¼Ÿ" class="headerlink" title="Qï¼šbrokerä¸»ä»æœåŠ¡å™¨éƒ½åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¶ˆæ¯æ¶ˆè´¹æ˜¯ä»ä¸»èŠ‚ç‚¹æ‹‰å–è¿˜æ˜¯ä»èŠ‚ç‚¹æ‹‰å–ï¼Ÿ"></a>Qï¼šbrokerä¸»ä»æœåŠ¡å™¨éƒ½åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¶ˆæ¯æ¶ˆè´¹æ˜¯ä»ä¸»èŠ‚ç‚¹æ‹‰å–è¿˜æ˜¯ä»èŠ‚ç‚¹æ‹‰å–ï¼Ÿ</h4><p>Aï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒRocketMQ æ¶ˆæ¯æ¶ˆè´¹è€…ä»<code>master</code>æœåŠ¡å™¨æ‹‰å–ï¼Œå½“<code>master</code>æœåŠ¡å™¨ç§¯å‹çš„æ¶ˆæ¯è¶… è¿‡äº†ç‰©ç†å†…å­˜çš„ 40%ï¼Œåˆ™å»ºè®®ä»<code>slave</code>æœåŠ¡å™¨æ‹‰å–ã€‚ä½†å¦‚æœ slaveReadEnable ä¸º falseï¼Œè¡¨ç¤º<code>slave</code>æœåŠ¡å™¨ä¸å¯è¯»ï¼Œ<code>slave</code>æœåŠ¡å™¨ä¹Ÿä¸ä¼šæ¥ç®¡æ¶ˆæ¯æ‹‰å–ã€‚</p><h4 id="Qï¼šå½“æ¶ˆæ¯æ¶ˆè´¹è€…å‘slaveæœåŠ¡å™¨æ‹‰å–æ¶ˆæ¯åï¼Œä¼šä¸€ç›´ä»slaveæœåŠ¡å™¨æ‹‰å–ï¼Ÿ"><a href="#Qï¼šå½“æ¶ˆæ¯æ¶ˆè´¹è€…å‘slaveæœåŠ¡å™¨æ‹‰å–æ¶ˆæ¯åï¼Œä¼šä¸€ç›´ä»slaveæœåŠ¡å™¨æ‹‰å–ï¼Ÿ" class="headerlink" title="Qï¼šå½“æ¶ˆæ¯æ¶ˆè´¹è€…å‘slaveæœåŠ¡å™¨æ‹‰å–æ¶ˆæ¯åï¼Œä¼šä¸€ç›´ä»slaveæœåŠ¡å™¨æ‹‰å–ï¼Ÿ"></a>Qï¼šå½“æ¶ˆæ¯æ¶ˆè´¹è€…å‘slaveæœåŠ¡å™¨æ‹‰å–æ¶ˆæ¯åï¼Œä¼šä¸€ç›´ä»slaveæœåŠ¡å™¨æ‹‰å–ï¼Ÿ</h4><p>Aï¼šä¸æ˜¯çš„ï¼Œåˆ†å¦‚ä¸‹æƒ…å†µï¼š</p><ol><li>å¦‚æœ<code>slave</code>æœåŠ¡å™¨çš„ slaveReadEnable è®¾ç½®ä¸º falseï¼Œåˆ™ä¸‹æ¬¡æ‹‰å–ï¼Œä»<code>masrer</code>æœåŠ¡å™¨æ‹‰å–ã€‚ </li><li>å¦‚æœ<code>slave</code>æœåŠ¡å™¨å…è®¸è¯»å–å¹¶ä¸”<code>slave</code>æœåŠ¡å™¨ç§¯å‹çš„æ¶ˆæ¯æœªè¶…è¿‡å…¶ç‰©ç†å†…å­˜çš„ 40%ï¼Œä¸‹æ¬¡æ‹‰å–ä½¿ç”¨çš„ Broker ä¸ºè®¢é˜…ç»„çš„ brokerId æŒ‡å®šçš„ Broker æœåŠ¡å™¨ï¼Œè¯¥å€¼é»˜è®¤ä¸º 0ï¼Œä»£è¡¨<code>master</code>æœåŠ¡å™¨ã€‚</li><li>å¦‚æœ<code>slave</code>æœåŠ¡å™¨å…è®¸è¯»å–å¹¶ä¸”<code>slave</code>æœåŠ¡å™¨ç§¯å‹çš„æ¶ˆæ¯è¶…è¿‡äº†å…¶ç‰©ç†å†…å­˜çš„ 40%ï¼Œä¸‹æ¬¡æ‹‰å–ä½¿ç”¨çš„ Broker ä¸ºè®¢é˜…ç»„çš„ whichBrokerWhenConsumeSlowly æŒ‡å®šçš„ Broker æœ åŠ¡å™¨ï¼Œè¯¥å€¼é»˜è®¤ä¸º 1ï¼Œä»£è¡¨<code>master</code>æœåŠ¡å™¨ã€‚</li></ol><h4 id="Qï¼šbrokerä¸»ä»èŠ‚ç‚¹çš„æ¶ˆè´¹è¿›åº¦æ˜¯å¦‚ä½•åŒæ­¥çš„ï¼Ÿ"><a href="#Qï¼šbrokerä¸»ä»èŠ‚ç‚¹çš„æ¶ˆè´¹è¿›åº¦æ˜¯å¦‚ä½•åŒæ­¥çš„ï¼Ÿ" class="headerlink" title="Qï¼šbrokerä¸»ä»èŠ‚ç‚¹çš„æ¶ˆè´¹è¿›åº¦æ˜¯å¦‚ä½•åŒæ­¥çš„ï¼Ÿ"></a>Qï¼šbrokerä¸»ä»èŠ‚ç‚¹çš„æ¶ˆè´¹è¿›åº¦æ˜¯å¦‚ä½•åŒæ­¥çš„ï¼Ÿ</h4><p>Aï¼š</p><ul><li>æ¶ˆæ¯æ¶ˆè´¹è¿›åº¦çš„åŒæ­¥æ˜¯å•å‘çš„ï¼Œ<code>slave</code>æœåŠ¡å™¨å¼€å¯ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œå®šæ—¶ä»<code>master</code>æœåŠ¡å™¨åŒæ­¥ æ¶ˆæ¯æ¶ˆè´¹è¿›åº¦ï¼›</li><li>æ— è®ºæ¶ˆæ¯æ¶ˆè´¹è€…æ˜¯ä»<code>master</code>æœåŠ¡å™¨æ‹‰çš„æ¶ˆæ¯è¿˜æ˜¯ä»<code>slave</code>æœåŠ¡å™¨æ‹‰å–çš„æ¶ˆæ¯ï¼Œåœ¨å‘ Broker åé¦ˆæ¶ˆæ¯æ¶ˆè´¹è¿›åº¦æ—¶ï¼Œä¼˜å…ˆå‘<code>master</code>æœåŠ¡å™¨æ±‡æŠ¥ï¼›</li><li>æ¶ˆæ¯æ¶ˆè´¹è€…å‘<code>master</code>æœåŠ¡å™¨æ‹‰å–æ¶ˆæ¯æ—¶ï¼Œ å¦‚æœæ¶ˆæ¯æ¶ˆè´¹è€…å†…å­˜ä¸­å­˜åœ¨æ¶ˆæ¯æ¶ˆè´¹è¿›åº¦æ—¶ï¼Œ<code>masrer</code>ä¼šå°è¯•æ›´æ–°æ¶ˆæ¯æ¶ˆè´¹è¿›åº¦ã€‚</li></ul><h4 id="Qï¼šæ¶ˆæ¯å‘é€æ˜¯å¦‚ä½•å®ç°é«˜å¯ç”¨çš„ï¼Ÿ"><a href="#Qï¼šæ¶ˆæ¯å‘é€æ˜¯å¦‚ä½•å®ç°é«˜å¯ç”¨çš„ï¼Ÿ" class="headerlink" title="Qï¼šæ¶ˆæ¯å‘é€æ˜¯å¦‚ä½•å®ç°é«˜å¯ç”¨çš„ï¼Ÿ"></a>Qï¼šæ¶ˆæ¯å‘é€æ˜¯å¦‚ä½•å®ç°é«˜å¯ç”¨çš„ï¼Ÿ</h4><blockquote><p>å¦‚æœ Broker ç«¯æ”¶åˆ°å†…å­˜æŠ–åŠ¨ç­‰å› ç´ é€ æˆå•æ¡å†™å…¥æ•°æ®å‘ç”ŸæŠ–åŠ¨ï¼Œå•ä¸ªBroker ç«¯ç§¯å‹çš„è¯·æ±‚å¤ªå¤§è¿˜å¾—ä¸åˆ°åŠæ—¶å¤„ç†ï¼Œä¼šæå¤§çš„é€ æˆå®¢æˆ·ç«¯æ¶ˆæ¯å‘é€çš„å»¶é•¿æ—¶é—´ï¼Œè®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æœç”±äº Broker å‹åŠ›å¢å¤§ï¼Œå†™å…¥ä¸€æ¡æ¶ˆæ¯éœ€è¦ 500ms ç”šè‡³è¶…è¿‡1sï¼Œå¹¶ä¸”é˜Ÿåˆ—ä¸­ç§¯å‹äº†5000 æ¡æ¶ˆæ¯ï¼Œæ¶ˆæ¯å‘é€ç«¯çš„é»˜è®¤è¶…æ—¶æ—¶é—´ä¸º 3sï¼Œå¦‚æœæŒ‰ç…§è¿™æ ·çš„é€Ÿåº¦ï¼Œè¿™äº›è¯·æ±‚åœ¨è½®åˆ°Broker æ‰§è¡Œå†™å…¥è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯å·²ç»å°†è¿™ä¸ªè¯·æ±‚è¶…æ—¶äº†ï¼Œè¿™æ ·ä¸ä»…ä¼šé€ æˆå¤§é‡çš„æ— æ•ˆå¤„ç†ï¼Œè¿˜ä¼šå¯¼è‡´å®¢æˆ·ç«¯å‘é€è¶…æ—¶ã€‚</p></blockquote><p>Brokerç«¯å¿«é€Ÿå¤±è´¥åŸç†å¦‚ä¸‹ï¼š</p><img src="https://cdn.jsdelivr.net/gh/HMYDK/picb@main/img/image-20220315141506789.png" alt="image-20220315141506789" style="zoom:80%;" /><ul><li>æ¶ˆæ¯å‘é€è€…å‘ Broker å‘é€æ¶ˆæ¯å†™å…¥è¯·æ±‚ï¼ŒBroker ç«¯åœ¨æ¥æ”¶åˆ°è¯·æ±‚åä¼šé¦–å…ˆæ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­(SendThreadPoolQueue)ï¼Œé»˜è®¤å®¹é‡ä¸º <u>10000</u>ã€‚</li><li>Broker ä¼šä¸“é—¨ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹æ± (SendMessageExecutor)å»ä»é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡å¹¶æ‰§è¡Œæ¶ˆæ¯å†™å…¥è¯·æ±‚ï¼Œä¸ºäº†ä¿è¯æ¶ˆæ¯çš„é¡ºåºå¤„ç†ï¼Œè¯¥çº¿ç¨‹æ± é»˜è®¤çº¿ç¨‹ä¸ªæ•°ä¸º<u>1</u>ã€‚</li><li>å¼€å¯ä¸€ä¸ªå®šæ—¶è°ƒåº¦çº¿ç¨‹ï¼Œæ¯éš” 10 æ¯«ç§’å»æ£€æŸ¥é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªæ’é˜ŸèŠ‚ç‚¹ï¼Œå¦‚æœè¯¥èŠ‚ç‚¹çš„æ’é˜Ÿæ—¶é—´å·²ç»è¶…è¿‡äº†200 msï¼Œå°±ä¼šå–æ¶ˆè¯¥é˜Ÿåˆ—ä¸­æ‰€æœ‰å·²è¶…è¿‡ 200ms çš„è¯·æ±‚ï¼Œç«‹å³å‘å®¢æˆ·ç«¯è¿”å›å¤±è´¥ï¼Œè¿™æ ·<u>å®¢æˆ·ç«¯èƒ½å°½å¿«è¿›è¡Œé‡è¯•</u>ï¼Œå› ä¸º Broker éƒ½æ˜¯é›†ç¾¤éƒ¨ç½²ï¼Œä¸‹æ¬¡é‡è¯•å¯ä»¥å‘é€åˆ°å…¶ä»–Broker ä¸Šï¼Œè¿™æ ·èƒ½æœ€å¤§ç¨‹åº¦ä¿è¯æ¶ˆæ¯å‘é€åœ¨é»˜è®¤ 3s çš„æ—¶é—´å†…ç»è¿‡é‡è¯•æœºåˆ¶ï¼Œèƒ½æœ‰æ•ˆé¿å…æŸä¸€å°Broker ç”±äºç¬æ—¶å‹åŠ›å¤§è€Œé€ æˆçš„æ¶ˆæ¯å‘é€ä¸å¯ç”¨ï¼Œä»è€Œå®ç°æ¶ˆæ¯å‘é€çš„é«˜å¯ç”¨ã€‚</li><li>ä¸šåŠ¡ä¸Šæˆ‘ä»¬åœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œåº”è¯¥åšå¥½å¼‚å¸¸æ•è·ï¼Œå°†å¤±è´¥æ¶ˆæ¯å…¥åº“ï¼Œå€ŸåŠ©å®šæ—¶ä»»åŠ¡åšé‡è¯•ã€‚</li></ul><h4 id="Qï¼šRocketMQè·¯ç”±å¯»æ‰¾æµç¨‹"><a href="#Qï¼šRocketMQè·¯ç”±å¯»æ‰¾æµç¨‹" class="headerlink" title="Qï¼šRocketMQè·¯ç”±å¯»æ‰¾æµç¨‹"></a>Qï¼šRocketMQè·¯ç”±å¯»æ‰¾æµç¨‹</h4><img src="https://cdn.jsdelivr.net/gh/HMYDK/picb@main/img/image-20220315161613014.png" alt="image-20220315161613014" style="zoom:80%;" /><ul><li>å¦‚æœ <code>Broker</code> å¼€å¯äº†è‡ªåŠ¨åˆ›å»º Topicï¼Œåœ¨å¯åŠ¨çš„æ—¶å€™ä¼šé»˜è®¤åˆ›å»ºä¸»é¢˜ï¼š<code>TBW102</code>ï¼Œå¹¶ä¼šéšç€ <code>Broker</code> å‘é€åˆ° <code>Nameserver</code> çš„å¿ƒè·³åŒ…æ±‡æŠ¥ç»™ <code>Nameserver</code>ï¼Œç»§è€Œä»<code>Nameserver</code> æŸ¥è¯¢è·¯ç”±ä¿¡æ¯æ—¶èƒ½è¿”å›è·¯ç”±ä¿¡æ¯ã€‚ </li><li>æ¶ˆæ¯å‘é€è€…åœ¨æ¶ˆæ¯å‘é€æ—¶é¦–å…ˆä¼šæŸ¥æœ¬åœ°ç¼“å­˜ï¼Œå¦‚æœæœ¬åœ°ç¼“å­˜ä¸­å­˜åœ¨ï¼Œç›´æ¥è¿”å›è·¯ç”±ä¿¡æ¯ã€‚</li><li>å¦‚æœç¼“å­˜ä¸å­˜åœ¨ï¼Œåˆ™å‘ <code>Nameserver</code> æŸ¥è¯¢è·¯ç”±ä¿¡æ¯ï¼Œå¦‚æœ <code>Nameserver</code> å­˜åœ¨è¯¥è·¯ç”±ä¿¡æ¯ï¼Œå°±ç›´æ¥è¿”å›ã€‚ </li><li>å¦‚æœ <code>Nameserver</code> ä¸å­˜åœ¨è¯¥ topic çš„è·¯ç”±ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰å¼€å¯è‡ªåŠ¨åˆ›å»ºä¸»é¢˜ï¼Œåˆ™æŠ›å‡ºNo route info of this topicã€‚ </li><li>å¦‚æœå¼€å¯äº†è‡ªåŠ¨åˆ›å»ºä¸»é¢˜ï¼Œåˆ™ä½¿ç”¨é»˜è®¤ä¸»é¢˜å‘ <code>Nameserver</code> æŸ¥è¯¢è·¯ç”±ä¿¡æ¯ï¼Œå¹¶ä½¿ç”¨é»˜è®¤ Topic çš„è·¯ç”±ä¿¡æ¯ä¸ºè‡ªå·±çš„è·¯ç”±ä¿¡æ¯ï¼Œå°†ä¸ä¼šæŠ›å‡º No route info of this topicã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> RocketMQ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RocketMQ </tag>
            
            <tag> Q&amp;A </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†å¸ƒå¼ä¸€è‡´æ€§åè®®ä¹‹Raft</title>
      <link href="/2022/030923896.html"/>
      <url>/2022/030923896.html</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘çœ‹<code>RocketMQ</code>çš„æ—¶å€™ï¼Œäº†è§£åˆ°v4.5.0ä¹‹åï¼Œbrokeré‡‡ç”¨éµå¾ªraftåè®®çš„å¤åˆ¶ç»„æ¥å®ç°æ•°æ®ä¸€è‡´æ€§ã€‚è™èº¯ä¸€éœ‡ï¼Œraftåè®®åœ¨ç°åœ¨çš„è„‘å­é‡Œå˜çš„ç†Ÿæ‚‰åˆé™Œç”Ÿâ€¦</p><p>é—®é¢˜ä¸å¤§ï¼Œé‡æ–°åˆ·ä¸€éraftã€‚</p><p>å…ˆè´´å®˜ç½‘ï¼š<a href="https://raft.github.io/">The Raft Consensus Algorithm</a></p><p>å†è´´åŠ¨ç”»æ¼”ç¤ºï¼š<a href="http://thesecretlivesofdata.com/raft">Raft: Understandable Distributed Consensus</a></p><p>psï¼šé‡Œè¾¹çš„åŠ¨å›¾æŒºæœ‰æ„æ€ğŸ˜ˆ</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ps:æ¥è‡ªç»´åŸºç™¾ç§‘</p><blockquote><p><strong>Raft</strong>æ˜¯ä¸€ç§ç”¨äºæ›¿ä»£<a href="https://zh.wikipedia.org/wiki/Paxos">Paxos</a>çš„<a href="https://zh.wikipedia.org/wiki/%E5%85%B1%E8%AD%98%E6%A9%9F%E5%88%B6">å…±è¯†</a>ç®—æ³•ã€‚ç›¸æ¯”äº<a href="https://zh.wikipedia.org/wiki/Paxos">Paxos</a>ï¼ŒRaftçš„ç›®æ ‡æ˜¯æä¾›æ›´æ¸…æ™°çš„é€»è¾‘åˆ†å·¥ä½¿å¾—ç®—æ³•æœ¬èº«èƒ½è¢«æ›´å¥½åœ°ç†è§£ï¼ŒåŒæ—¶å®ƒå®‰å…¨æ€§æ›´é«˜ï¼Œå¹¶èƒ½æä¾›ä¸€äº›é¢å¤–çš„ç‰¹æ€§ã€‚[<a href="https://zh.wikipedia.org/wiki/Raft#cite_note-raft-1">1]</a>[<a href="https://zh.wikipedia.org/wiki/Raft#cite_note-raft-paper-2">2]</a>:1Raftèƒ½ä¸ºåœ¨<a href="https://zh.wikipedia.org/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%9B%86%E7%BE%A4">è®¡ç®—æœºé›†ç¾¤</a>ä¹‹é—´éƒ¨ç½²<a href="https://zh.wikipedia.org/wiki/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E6%9C%BA">æœ‰é™çŠ¶æ€æœº</a>æä¾›ä¸€ç§é€šç”¨æ–¹æ³•ï¼Œå¹¶ç¡®ä¿é›†ç¾¤å†…çš„ä»»æ„èŠ‚ç‚¹åœ¨æŸç§çŠ¶æ€è½¬æ¢ä¸Šä¿æŒä¸€è‡´ã€‚Raftç®—æ³•çš„å¼€æºå®ç°ä¼—å¤šï¼Œåœ¨<a href="https://zh.wikipedia.org/wiki/Go">Go</a>ã€<a href="https://zh.wikipedia.org/wiki/C%2B%2B">C++</a>ã€<a href="https://zh.wikipedia.org/wiki/Java">Java</a>ä»¥åŠ <a href="https://zh.wikipedia.org/wiki/Scala">Scala</a>ä¸­éƒ½æœ‰å®Œæ•´çš„ä»£ç å®ç°ã€‚Raftè¿™ä¸€åå­—æ¥æºäºâ€Reliable, Replicated, Redundant, And Fault-Tolerantâ€ï¼ˆâ€œå¯é ã€å¯å¤åˆ¶ã€å¯å†—ä½™ã€å¯å®¹é”™â€ï¼‰çš„é¦–å­—æ¯ç¼©å†™ã€‚[<a href="https://zh.wikipedia.org/wiki/Raft#cite_note-3">3]</a></p><p>é›†ç¾¤å†…çš„èŠ‚ç‚¹éƒ½å¯¹é€‰ä¸¾å‡ºçš„é¢†è¢–é‡‡å–ä¿¡ä»»ï¼Œå› æ­¤Raftä¸æ˜¯ä¸€ç§<a href="https://zh.wikipedia.org/wiki/%E6%8B%9C%E5%8D%A0%E5%BA%AD%E5%B0%86%E5%86%9B%E9%97%AE%E9%A2%98">æ‹œå åº­å®¹é”™</a>ç®—æ³•ã€‚[<a href="https://zh.wikipedia.org/wiki/Raft#cite_note-raft-paper-2">2]</a></p></blockquote><p>Raftä½¿ç”¨<strong>é€‰ä¸¾é¢†è¢–</strong>çš„æ–¹å¼åšå…±è¯†ç®—æ³•ã€‚ä¸€ä¸ªå…¸å‹çš„Raft clusterä¸€èˆ¬æœ‰5å°æœåŠ¡å™¨ï¼Œè¿™å¯ä»¥åº”å¯¹ä¸¤æ¬¡æ•…éšœã€‚</p><p>åœ¨ä¸€ä¸ªRaft clusteré‡Œï¼ŒæœåŠ¡å™¨æœ‰ä¸‰ç§èº«ä»½ï¼š</p><ol><li>é¢†è¢–ï¼ˆleaderï¼‰</li><li>è·Ÿéšè€…ï¼ˆfollowerï¼‰</li><li>å€™é€‰äººï¼ˆcandidateï¼‰</li></ol><p><code>leader</code>åœ¨åŒä¸€æ—¶é—´åªä¼šæœ‰ä¸€ä¸ªï¼Œä½†ä¸æ˜¯ä¸€æˆä¸å˜çš„ã€‚å‰©ä¸‹çš„æœåŠ¡å™¨éƒ½æ˜¯<code>follower</code>ã€‚</p><p><code>leader</code>ä¼šå¤„ç†æ‰€æœ‰çš„å¤–éƒ¨è¯·æ±‚ï¼Œå¦‚æœä¸€ä¸ªæœåŠ¡å™¨ä¸æ˜¯<code>leader</code>ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯·æ±‚ä¼šè¢«è½¬å‘åˆ°<code>leader</code>å¤„ç†ã€‚</p><p><code>leader</code>ä¼šåœ¨ä¸€ä¸ªå›ºå®šçš„æ—¶é—´æ®µé‡Œç»™<code>follower</code>å‘é€å¿ƒè·³ï¼ˆheartbeatï¼‰ï¼Œå‘Šè¯‰<code>follower</code>ï¼š<em><strong>hi boys ! I am alive !</strong></em> ğŸ’‹ </p><p>æ¯ä¸ª<code>follower</code>éƒ½æœ‰è‡ªå·±çš„è¶…æ—¶çª—å£ï¼ˆæ¯ä¸ªfollowerçš„timeoutå¯èƒ½ä¸ä¸€æ ·ï¼‰ï¼Œå½“è¶…è¿‡ä¸€å®šæ—¶é—´æ²¡æœ‰æ”¶åˆ°<code>leader</code>çš„heartbeatä¹‹åï¼Œé›†ç¾¤å°±ä¼šè¿›å…¥é€‰ä¸¾çŠ¶æ€ã€‚ğŸ™‹</p><p>ä»ä¸‹è¾¹ä¸‰ä¸ªæ–¹é¢æ¥äº†è§£<code>raft</code></p><ul><li>é¢†è¢–é€‰ä¸¾ï¼ˆLeader Electionï¼‰</li><li>è®°å½•å¤å†™ï¼ˆLog Replicationï¼‰</li><li>å®‰å…¨æ€§ï¼ˆSafetyï¼‰</li></ul><h2 id="é¢†è¢–é€‰ä¸¾ï¼ˆleader-electionï¼‰"><a href="#é¢†è¢–é€‰ä¸¾ï¼ˆleader-electionï¼‰" class="headerlink" title="é¢†è¢–é€‰ä¸¾ï¼ˆleader electionï¼‰"></a>é¢†è¢–é€‰ä¸¾ï¼ˆleader electionï¼‰</h2><img src="https://s3.bmp.ovh/imgs/2022/03/4f18033de732207c.png" alt="image-20220309153949284" style="zoom:80%;" /><p>ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹æœŸåˆéƒ½æ˜¯followerè§’è‰²ï¼Œå¦‚æœåœ¨ä¸€æ®µæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°leaderçš„å¿ƒè·³ï¼ˆtimes outï¼‰ï¼Œé‚£ä¹ˆä¾¿åˆ‡æ¢åˆ°candidateè§’è‰²ï¼Œç„¶åå‘èµ·é€‰ä¸¾ï¼ˆstarts electionï¼‰ï¼›å¦‚æœæ”¶åˆ°å¤§å¤šæ•°çš„æŠ•ç¥¨ï¼Œé‚£ä¹ˆåˆ‡æ¢æˆleaderè§’è‰²ï¼›</p><p>æœ‰ä¸¤ä¸ª<code>è¶…æ—¶æ—¶é—´</code>ï¼ˆtimeoutï¼‰ä¼šå½±å“leader election:</p><h3 id="election-timeout"><a href="#election-timeout" class="headerlink" title="election timeout"></a><strong>election timeout</strong></h3><p>followerç­‰å¾…æˆä¸ºcandidateçš„æ—¶é—´ï¼Œè¿™ä¸ªæ—¶é—´åœ¨150ms~300msçš„èŒƒå›´å†…æ˜¯éšæœºçš„ã€‚</p><p>å¦‚æœè¶…è¿‡äº†è¿™ä¸ªtimeoutæ—¶é—´è¿˜æ²¡æœ‰æ”¶åˆ°leaderçš„å¿ƒè·³ï¼Œé‚£ä¹ˆè¿™ä¸ªfollowerä¼šåšä¸‹è¾¹ä¸¤ä»¶äº‹ï¼š</p><ol><li>åˆ‡æ¢æˆcandidateçš„è§’è‰²</li><li>å®ƒçš„Term : 0-&gt;1 and  Vote Count : 0 -&gt;1 </li></ol><p>ç„¶åï¼Œå®ƒä¼šå‘å…¶å®ƒæ‰€æœ‰èŠ‚ç‚¹ï¼ˆnodesï¼‰å‘é€ä¸€ä¸ª<em>æŠ•ç¥¨è¯·æ±‚</em>ï¼ˆ<code>Request Vote</code>ï¼‰ã€‚å¦‚æœæ¥å—è¿™ä¸ªè¯·æ±‚çš„èŠ‚ç‚¹åœ¨æ­¤ä»»æœŸï¼ˆTermï¼‰å†…è¿˜æ²¡æœ‰æŠ•è¿‡ç¥¨ï¼Œé‚£ä¹ˆå°±ä¼šæŠ•è¿™ä¸ªRequest Voteçš„å‘èµ·æ–¹ï¼Œ<u>å¹¶ä¸”å°†è‡ªå·±çš„election timeouté‡ç½®</u>ã€‚</p><img src="https://s3.bmp.ovh/imgs/2022/03/dd72e822d6c9dfc3.png" alt="image-20220309161641140" style="zoom: 50%;" /><p>å½“ä¸€ä¸ªcandidateèŠ‚ç‚¹æœ‰å¤§å¤šæ•°çš„æŠ•ç¥¨çš„æ—¶å€™ï¼Œé‚£ä¹ˆå’Œè¿™ä¸ªèŠ‚ç‚¹åˆ‡æ¢ä¸º<code>leader</code>èŠ‚ç‚¹ã€‚</p><h3 id="heartbeat-timeout"><a href="#heartbeat-timeout" class="headerlink" title="heartbeat timeout"></a>heartbeat timeout</h3><p>leaderèŠ‚ç‚¹å¼€å§‹å‘é€<code>Append Entries</code>ä¿¡æ¯åˆ°æ‰€æœ‰çš„followerèŠ‚ç‚¹ï¼Œè¿™äº›ä¿¡æ¯æŒ‰ç…§<strong>heartbeat timeout</strong>æŒ‡å®šçš„æ—¶é—´é—´éš”å»å‘é€ã€‚followersæ”¶åˆ°Append Entriesè¯·æ±‚å<u>ä¼šé‡ç½®è‡ªå·±çš„election timeoutå¹¶ä¸”åšå‡ºå“åº”</u>ã€‚</p><img src="https://s3.bmp.ovh/imgs/2022/03/ebe0ba4e35560cd4.png" alt="image-20220309164255003" style="zoom:50%;" /><p>è‡³æ­¤ï¼Œè¿™ä¸ªä»»æœŸï¼ˆTermï¼‰å°†ä¼šä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ°æŸä¸€ä¸ªfolloweræ”¶ä¸åˆ°leaderçš„å¿ƒè·³å¹¶ä¸”åˆ‡æ¢æˆäº†candidateè§’è‰²ã€‚</p><h3 id="NOTE"><a href="#NOTE" class="headerlink" title="NOTE"></a>NOTE</h3><ol><li>åœ¨ä¸€ä¸ªå¶æ•°çš„raft clusterä¸­ä¸€æ—¦leaderä¸å¯ç”¨ï¼Œå‰©ä¸‹çš„å‡ ä¸ªcandidateåœ¨åŒä¸€æ—¶é—´å¯èƒ½æœ‰â€œè„‘è£‚â€ï¼ˆsplit voteï¼‰çš„é£é™©ã€‚å½“ç„¶è¿™ç§caseå‘ç”Ÿçš„æ¦‚ç‡è¿˜æ˜¯æä½çš„ï¼Œåªæœ‰åœ¨leaderä¸å¯ç”¨æ—¶ï¼Œå‰©ä¸‹çš„candidateä¸­æœ‰ä¸¤ä¸ªèŠ‚ç‚¹çš„å‰©ä½™election timeå®Œå…¨ä¸€è‡´æ—¶æ‰ä¼šå‘ç”Ÿã€‚æ‰€ä»¥å®˜æ–¹å»ºè®®ä¸€ä¸ªraft clusteræœ€å°‘è¦æœ‰äº”ä¸ªèŠ‚ç‚¹ã€‚</li><li>ä¸ºäº†é¿å…<code>split vote</code>ï¼Œraftå¼•å…¥äº†<code>randomized election timeouts</code>é¿å…å¹³ç¥¨çš„caseå‘ç”Ÿã€‚</li><li>raftæ˜¯ä¸€ä¸ª<code>leader-based</code>å…±è¯†ç®—æ³•ï¼ŒèŠ‚ç‚¹çš„æ•°æ®å°½é‡æ˜¯å¥‡æ•°ä¸ªï¼Œè¿™æ ·å¯ä»¥å°½é‡ä¿è¯<code>majority</code>çš„å‡ºç°ã€‚</li></ol><h2 id="è®°å½•å¤å†™ï¼ˆlog-replicationï¼‰"><a href="#è®°å½•å¤å†™ï¼ˆlog-replicationï¼‰" class="headerlink" title="è®°å½•å¤å†™ï¼ˆlog replicationï¼‰"></a>è®°å½•å¤å†™ï¼ˆlog replicationï¼‰</h2><p>å½“é›†ç¾¤ä¸­çš„leaderè¢«é€‰ä¸¾å‡ºæ¥ä¹‹åï¼Œå®¢æˆ·ç«¯çš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šå‘é€åˆ°leaderï¼Œleaderæ¥è°ƒåº¦è¿™äº›è¯·æ±‚çš„é¡ºåºï¼Œå¹¶ä¸”è¦ä¿è¯leaderä¸followersçŠ¶æ€çš„ä¸€è‡´æ€§ã€‚</p><h3 id="Replicated-state-machines"><a href="#Replicated-state-machines" class="headerlink" title="Replicated state machines"></a>Replicated state machines</h3><p>å…±è¯†ç®—æ³•ä¸€èˆ¬æ˜¯åŸºäºå¤åˆ¶çŠ¶æ€æœºï¼ˆReplicated state machinesï¼‰å®ç°çš„ã€‚</p><p>psï¼š<em>ä¸å±•å¼€äº†ï¼Œæœ‰æ—¶é—´å†ä¸“é—¨å†™ä¸€ç¯‡</em>ğŸƒâ€â™€ï¸ğŸƒâ€â™‚ï¸</p><p>raftä¸­ï¼Œ<code>leader</code>å°†å®¢æˆ·ç«¯è¯·æ±‚(command)å°è£…æˆä¸€ä¸ªä¸ª<code>log entry</code>ï¼Œç„¶åå°†è¿™äº›<code>log entries</code>å¤åˆ¶ï¼ˆreplicateï¼‰åˆ°æ‰€æœ‰çš„<code>follower</code>èŠ‚ç‚¹ï¼Œç„¶åæ‰€æœ‰èŠ‚ç‚¹æŒ‰ç…§é¡ºåºåº”ç”¨<code>log entry</code>ä¸­çš„<code>command</code>ï¼Œé‚£ä¹ˆå¤§å®¶æœ€ç»ˆçš„çŠ¶æ€å°±æ˜¯ä¸€è‡´çš„äº†ã€‚</p><img src="https://s3.bmp.ovh/imgs/2022/03/fb6457b7c11d6578.png" alt="image-20220309215626133" style="zoom: 80%;" /><h3 id="è¯·æ±‚æµç¨‹"><a href="#è¯·æ±‚æµç¨‹" class="headerlink" title="è¯·æ±‚æµç¨‹"></a>è¯·æ±‚æµç¨‹</h3><ol><li>clientå‘äº†ä¸€ä¸ªè¯·æ±‚ç»™åˆ°leaderï¼Œleaderå°†â€œå˜åŒ–â€ï¼ˆchangeï¼‰æ·»åŠ ï¼ˆappendedï¼‰åˆ°è‡ªå·±çš„logä¸­ã€‚</li><li>leaderåœ¨ä¸‹ä¸€æ¬¡heartbeatæ—¶ï¼Œå°†â€œå˜åŒ–â€ï¼ˆchangeï¼‰å‘é€åˆ°æ‰€æœ‰çš„followers</li><li>ä¸€æ—¦å¤§å¤šæ•°followeræ‰¿è®¤äº†è¿™ä¸ªæ¡ç›®ï¼ˆentryï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¡ç›®å°±ä¼šè¢«æäº¤ï¼ˆcommittedï¼‰<ol><li>ç±»ä¼¼2PCï¼ŒåŒºåˆ«æ˜¯leaderä¸éœ€è¦å…¨éƒ¨èŠ‚ç‚¹çš„å›å¤ï¼Œè¿™æ ·åªè¦è¶…è¿‡ä¸€åŠèŠ‚ç‚¹å¤„äºå·¥ä½œçŠ¶æ€åˆ™ç³»ç»Ÿå°±æ˜¯å¯ç”¨çš„</li></ol></li><li>leaderå°†è¯·æ±‚responseå‘é€åˆ°client</li></ol><h3 id="NOTE-1"><a href="#NOTE-1" class="headerlink" title="NOTE"></a>NOTE</h3><ul><li>Raftå¯ä»¥åœ¨ç½‘ç»œåˆ†åŒºï¼ˆnetwork partitionsï¼‰æ—¶ä¿æŒä¸€è‡´</li><li>raftç®—æ³•ä¸ºäº†ä¿è¯é«˜å¯ç”¨ï¼Œå¹¶ä¸æ˜¯å¼ºä¸€è‡´çš„ï¼Œè€Œæ˜¯æœ€ç»ˆä¸€è‡´çš„</li></ul><h2 id="å®‰å…¨æ€§ï¼ˆsafetyï¼‰"><a href="#å®‰å…¨æ€§ï¼ˆsafetyï¼‰" class="headerlink" title="å®‰å…¨æ€§ï¼ˆsafetyï¼‰"></a>å®‰å…¨æ€§ï¼ˆsafetyï¼‰</h2><p>æ²¡æ—¶é—´äº†ï¼Œä¸‹æ¬¡å†è¯´â€¦ğŸƒâ€â™‚ï¸</p>]]></content>
      
      
      <categories>
          
          <category> åˆ†å¸ƒå¼ä¸€è‡´æ€§åè®® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> raft </tag>
            
            <tag> åˆ†å¸ƒå¼ </tag>
            
            <tag> ä¸€è‡´æ€§åè®® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git-rebaseå…¥é—¨æ•™ç¨‹</title>
      <link href="/2022/030854417.html"/>
      <url>/2022/030854417.html</url>
      
        <content type="html"><![CDATA[<img src="https://www.runoob.com/wp-content/uploads/2015/02/git-command.jpg" style="zoom: 150%;" /><h2 id="rebaseåŸºç¡€ä»‹ç»"><a href="#rebaseåŸºç¡€ä»‹ç»" class="headerlink" title="rebaseåŸºç¡€ä»‹ç»"></a>rebaseåŸºç¡€ä»‹ç»</h2><p>gitä»£ç åˆå¹¶æœ‰ä¸¤ç§ï¼Œgit merge å’Œ git rebase ã€‚ä¸¤è€…ç›®çš„ç›¸åŒï¼Œéƒ½æ˜¯æŠŠä¸åŒåˆ†æ”¯çš„æäº¤åˆå¹¶åˆ°ä¸€èµ·ï¼Œä½†æ˜¯è¿‡ç¨‹æœ‰å·®å¼‚ã€‚</p><p><strong>git merge</strong></p><p>ä½œç”¨ï¼šæŠŠæºåˆ†æ”¯çš„æäº¤åˆå¹¶åˆ°ç›®æ ‡åˆ†æ”¯ã€‚è¿‡ç¨‹ä¸­ï¼Œç›®æ ‡åˆ†æ”¯æ”¹å˜ï¼Œæºåˆ†æ”¯ä¸å˜ã€‚</p><p>ä¼˜ç‚¹ï¼šç®€å•æ˜“ä¸Šæ‰‹/ä¿ç•™äº†æäº¤å†å²å’Œæ—¶é—´æ¬¡åº/åˆ†æ”¯ç»“æ„ä¸å˜</p><p>ç¼ºç‚¹ï¼šæäº¤å†å²è¢«å¤§é‡çš„mergeæ“ä½œæ±¡æŸ“/<a href="http://www.ruanyifeng.com/blog/2018/12/git-bisect.html">git bisect</a>è°ƒè¯•å›°éš¾</p><p><strong>git rebase</strong></p><p>ä½œç”¨ï¼šæ¸…é™¤äº†å†å²ï¼Œå°†ä¸€ä¸ªåˆ†æ”¯å®Œå…¨è½¬ç§»åˆ°äº†ç›®æ ‡åˆ†æ”¯</p><p>ä¼˜ç‚¹ï¼šå¤æ‚çš„å†å²å˜æˆä¼˜é›…çš„æäº¤çº¿</p><p>ç¼ºç‚¹ï¼šåˆ†æ”¯ä¸Šä¸‹æ–‡æ¨¡ç³Šäº†/devåˆ†æ”¯ä»¥åŠfeatureåˆ†æ”¯éœ€è¦ç»å¸¸æ›´æ–°releaseåˆ†æ”¯å˜åŠ¨åˆ°æœ¬åœ°</p><img src="/2022/030854417/rebse-merge.png" class="" title="å›¾ç‰‡å¼•ç”¨æ–¹æ³•ä¸€"><h2 id="ä½¿ç”¨rebaseæ—¶ï¼Œæ­£ç¡®çš„git-flowæ˜¯æ€æ ·çš„"><a href="#ä½¿ç”¨rebaseæ—¶ï¼Œæ­£ç¡®çš„git-flowæ˜¯æ€æ ·çš„" class="headerlink" title="ä½¿ç”¨rebaseæ—¶ï¼Œæ­£ç¡®çš„git flowæ˜¯æ€æ ·çš„"></a>ä½¿ç”¨rebaseæ—¶ï¼Œæ­£ç¡®çš„git flowæ˜¯æ€æ ·çš„</h2><ul><li>æ¯ä¸ªfeatureåˆ†æ”¯éƒ½æœ‰å•ç‹¬çš„åˆ†æ”¯è´Ÿè´£äººï¼Œåˆ†æ”¯è´Ÿè´£äººéœ€è¦åœ¨featureåˆ†æ”¯å¼€å‘è¿‡ç¨‹ä¸­æ¯å¤©rebase  releaseåˆ†æ”¯ï¼ŒåŒæ—¶å‘Šè¯‰featureåˆ†æ”¯çš„è‡ªå¼€å‘åˆ†æ”¯ï¼ŒåŠæ—¶è·Ÿè¿›æ›´æ–°ã€‚</li><li>featureå­åˆ†æ”¯å¼€å‘äººå‘˜éœ€è¦åœ¨å¼€å‘å®Œè‡ªå·±çš„ä»»åŠ¡ä¹‹åï¼Œå°†è‡ªå·±åˆ†æ”¯çš„ç‚¹åˆå¹¶æˆä¸€ä¸ªç‚¹ï¼Œç„¶ååˆå¹¶åˆ°featureåˆ†æ”¯ã€‚</li><li>featureåˆ†æ”¯è´Ÿè´£äººåœ¨ç¡®å®šæ‰€æœ‰å­åˆ†æ”¯éƒ½å·²å¼€å‘å®Œæ¯•å¹¶ä¸”éƒ½å‹ç‚¹ååˆå¹¶åˆ°featureåˆ†æ”¯åï¼Œäº¤ä»˜æµ‹è¯•éªŒæ”¶ã€‚</li><li>æµ‹è¯•éªŒæ”¶é€šè¿‡åå°†featureåˆ°releaseåˆ†æ”¯ç­‰å¾…ä¸Šçº¿ã€‚</li></ul><h3 id="1-featureè´Ÿè´£äººæ‹‰å‡ºåŠŸèƒ½åˆ†æ”¯ï¼Œå¹¶å‘ŠçŸ¥åŠŸèƒ½å¼€å‘äººå‘˜ç›¸å…³åˆ†æ”¯å·²æ‹‰å‡ºï¼Œå¯ä»¥åˆ›å»ºè‡ªå·±çš„å¼€å‘åˆ†æ”¯ã€‚"><a href="#1-featureè´Ÿè´£äººæ‹‰å‡ºåŠŸèƒ½åˆ†æ”¯ï¼Œå¹¶å‘ŠçŸ¥åŠŸèƒ½å¼€å‘äººå‘˜ç›¸å…³åˆ†æ”¯å·²æ‹‰å‡ºï¼Œå¯ä»¥åˆ›å»ºè‡ªå·±çš„å¼€å‘åˆ†æ”¯ã€‚" class="headerlink" title="1.featureè´Ÿè´£äººæ‹‰å‡ºåŠŸèƒ½åˆ†æ”¯ï¼Œå¹¶å‘ŠçŸ¥åŠŸèƒ½å¼€å‘äººå‘˜ç›¸å…³åˆ†æ”¯å·²æ‹‰å‡ºï¼Œå¯ä»¥åˆ›å»ºè‡ªå·±çš„å¼€å‘åˆ†æ”¯ã€‚"></a>1.<strong>featureè´Ÿè´£äººæ‹‰å‡ºåŠŸèƒ½åˆ†æ”¯ï¼Œå¹¶å‘ŠçŸ¥åŠŸèƒ½å¼€å‘äººå‘˜ç›¸å…³åˆ†æ”¯å·²æ‹‰å‡ºï¼Œå¯ä»¥åˆ›å»ºè‡ªå·±çš„å¼€å‘åˆ†æ”¯ã€‚</strong></h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git checkout -b feature-xxx$ git push --set-upstream origin feature-xxx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="2-featureå¼€å‘äººå‘˜æ‹‰å‡ºå±äºè‡ªå·±çš„ä¸šåŠ¡å¼€å‘åˆ†æ”¯"><a href="#2-featureå¼€å‘äººå‘˜æ‹‰å‡ºå±äºè‡ªå·±çš„ä¸šåŠ¡å¼€å‘åˆ†æ”¯" class="headerlink" title="2.featureå¼€å‘äººå‘˜æ‹‰å‡ºå±äºè‡ªå·±çš„ä¸šåŠ¡å¼€å‘åˆ†æ”¯"></a>2.<strong>featureå¼€å‘äººå‘˜æ‹‰å‡ºå±äºè‡ªå·±çš„ä¸šåŠ¡å¼€å‘åˆ†æ”¯</strong></h3><p>å¼ ä¸‰</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git checkout -b feature-xxx-zhangsan$ git push --set-upstream origin feature-xxx-zhangsan<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æå››</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git checkout -b feature-xxx-lisi$ git push --set-upstream origin feature-xxx-lisi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="3-featureå¼€å‘äººå‘˜å¼€å§‹åšä¸šåŠ¡å¼€å‘"><a href="#3-featureå¼€å‘äººå‘˜å¼€å§‹åšä¸šåŠ¡å¼€å‘" class="headerlink" title="3.featureå¼€å‘äººå‘˜å¼€å§‹åšä¸šåŠ¡å¼€å‘"></a>3.<strong>featureå¼€å‘äººå‘˜å¼€å§‹åšä¸šåŠ¡å¼€å‘</strong></h3><p>å¼ ä¸‰</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git add .$ git commit -m &#39;å¼ ä¸‰æäº¤1&#39;$ git push<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git add .$ git commit -m &#39;å¼ ä¸‰æäº¤2&#39;$ git push<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æå››</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git add .$ git commit -m &#39;æå››æäº¤1&#39;$ git push<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git add .$ git commit -m &#39;æå››æäº¤2&#39;$ git push<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="/2022/030854417/image-20210808225537689.png" class="" title="å›¾ç‰‡å¼•ç”¨æ–¹æ³•ä¸€"><h3 id="4-fearureå¼€å‘äººå‘˜å®Œæˆè‡ªå·±çš„å¼€å‘ä»»åŠ¡ä¹‹åå°†è‡ªå·±çš„æäº¤è®°å½•åˆå¹¶æˆä¸€ä¸ªç‚¹"><a href="#4-fearureå¼€å‘äººå‘˜å®Œæˆè‡ªå·±çš„å¼€å‘ä»»åŠ¡ä¹‹åå°†è‡ªå·±çš„æäº¤è®°å½•åˆå¹¶æˆä¸€ä¸ªç‚¹" class="headerlink" title="4.fearureå¼€å‘äººå‘˜å®Œæˆè‡ªå·±çš„å¼€å‘ä»»åŠ¡ä¹‹åå°†è‡ªå·±çš„æäº¤è®°å½•åˆå¹¶æˆä¸€ä¸ªç‚¹"></a>4.fearureå¼€å‘äººå‘˜å®Œæˆè‡ªå·±çš„å¼€å‘ä»»åŠ¡ä¹‹åå°†è‡ªå·±çš„æäº¤è®°å½•åˆå¹¶æˆä¸€ä¸ªç‚¹</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git rebase -i 292141c  5b43fa0-------------------------pick 6e48844 å¼ ä¸‰æäº¤1pick 5f8e351 å¼ ä¸‰æäº¤2     &#x2F;&#x2F;è¿›å…¥ç¼–è¾‘æ¨¡å¼å°†ç¬¬äºŒè¡Œå¼€å§‹çš„pickå…¨éƒ¨ä¿®æ”¹æˆsï¼Œç„¶åesc :wqä¿å­˜ï¼Œè¿›å…¥commit msgç•Œé¢åšæ•´ç†# Rebase 356a5c0..5f8e351 onto 356a5c0 (2 commands)## Commands:# p, pick &lt;commit&gt; &#x3D; use commit# r, reword &lt;commit&gt; &#x3D; use commit, but edit the commit message# e, edit &lt;commit&gt; &#x3D; use commit, but stop for amending# s, squash &lt;commit&gt; &#x3D; use commit, but meld into previous commit# f, fixup &lt;commit&gt; &#x3D; like &quot;squash&quot;, but discard this commit&#39;s log message# x, exec &lt;command&gt; &#x3D; run command (the rest of the line) using shell# b, break &#x3D; stop here (continue rebase later with &#39;git rebase --continue&#39;)# d, drop &lt;commit&gt; &#x3D; remove commit# l, label &lt;label&gt; &#x3D; label current HEAD with a name# t, reset &lt;label&gt; &#x3D; reset HEAD to a label# m, merge [-C &lt;commit&gt; | -c &lt;commit&gt;] &lt;label&gt; [# &lt;oneline&gt;]# .       create a merge commit using the original merge commit&#39;s# .       message (or the oneline, if no original merge commit was# .       specified). Use -c &lt;commit&gt; to reword the commit message.## These lines can be re-ordered; they are executed from top to bottom.## If you remove a line here THAT COMMIT WILL BE LOST.## However, if you remove everything, the rebase will be aborted.#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/2022/030854417/git-rebase.gif" class="" title="å›¾ç‰‡å¼•ç”¨æ–¹æ³•ä¸€"><img src="/2022/030854417/image-20210808233344850.png" class="" title="å›¾ç‰‡å¼•ç”¨æ–¹æ³•ä¸€"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git statusOn branch feature-xxx-zhangsanYour branch and &#39;origin&#x2F;feature-xxx-zhangsan&#39; have diverged,and have 1 and 2 different commits each, respectively.  (use &quot;git pull&quot; to merge the remote branch into yours)nothing to commit, working tree clean<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>idea git ä¸­å¯ä»¥çœ‹åˆ°feature-xxx-zhangsançš„æœ¬åœ°åˆ†æ”¯å·²ç»å°†ä¸¤æ¬¡æäº¤åˆå¹¶æˆ<strong>ä¸€ä¸ªç‚¹</strong></p><blockquote><p>have 1 and 2 different commits each, respectively.</p></blockquote><p>æ­¤æ—¶éœ€è¦å°†æœ¬åœ°åˆ†æ”¯<strong>å¼ºæ¨</strong>åˆ°è¿œç¨‹åˆ†æ”¯</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git push -f <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/2022/030854417/image-20210808233945968.png" class="" title="å›¾ç‰‡å¼•ç”¨æ–¹æ³•ä¸€"><h3 id="5-åˆå¹¶åˆ°featureåˆ†æ”¯"><a href="#5-åˆå¹¶åˆ°featureåˆ†æ”¯" class="headerlink" title="5.åˆå¹¶åˆ°featureåˆ†æ”¯"></a>5.åˆå¹¶åˆ°featureåˆ†æ”¯</h3><p>å…ˆä¿è¯æœ¬åœ°çš„featureåˆ†æ”¯æ˜¯æœ€æ–°çš„</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git checkout feature-xxx$ git pull$ git status<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>åˆå¹¶åˆ†æ”¯</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git rebase feature-xxx-zhangsan feature-xxxSuccessfully rebased and updated refs&#x2F;heads&#x2F;feature-xxx.æ³¨æ„æ­¤æ—¶çš„æœ¬åœ°åˆ†æ”¯å·²ç»åˆ‡æ¢åˆ°feature-xxxï¼Œä¹Ÿå°±æ˜¯rebaseå‘½ä»¤çš„ç¬¬äºŒä¸ªå‚æ•°gir rebase branchA branchBå…¶å®ä¼šåšä¸¤ä»¶äº‹æƒ…1.git checkout branchB2.git rebase branchA$ git branch* feature-xxx  feature-xxx-lisi  feature-xxx-zhangsan  main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git statusOn branch feature-xxxYour branch is ahead of &#39;origin&#x2F;feature-xxx&#39; by 1 commit.  (use &quot;git push&quot; to publish your local commits)nothing to commit, working tree clean<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>git statuså¯ä»¥çœ‹åˆ°feature-xxxåˆ†æ”¯ä¸Šå·²ç»æœ‰äº†feature-xxx-zhangsanåˆ†æ”¯åˆå¹¶çš„ç‚¹</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git push<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="6-åˆå¹¶åˆ°åŠŸèƒ½åˆ†æ”¯çš„æ—¶å€™å‡ºç°å†²çªæ€ä¹ˆåŠ"><a href="#6-åˆå¹¶åˆ°åŠŸèƒ½åˆ†æ”¯çš„æ—¶å€™å‡ºç°å†²çªæ€ä¹ˆåŠ" class="headerlink" title="6.åˆå¹¶åˆ°åŠŸèƒ½åˆ†æ”¯çš„æ—¶å€™å‡ºç°å†²çªæ€ä¹ˆåŠ"></a>6.åˆå¹¶åˆ°åŠŸèƒ½åˆ†æ”¯çš„æ—¶å€™å‡ºç°å†²çªæ€ä¹ˆåŠ</h3><p>æå››åŒæ ·èµ°äº†è¿™ä¸ªæµç¨‹ä½†æ˜¯åœ¨åˆå¹¶åˆ°featureåˆ†æ”¯çš„æ—¶å€™é‡åˆ°äº†éº»çƒ¦ï¼Œæœ‰ä»£ç å†²çªäº†</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git rebase feature-xxx-lisi feature-xxxSuccessfully rebased and updated refs&#x2F;heads&#x2F;feature-xxx.$ git statusOn branch feature-xxxYour branch and &#39;origin&#x2F;feature-xxx&#39; have diverged,and have 1 and 1 different commits each, respectively.  (use &quot;git pull&quot; to merge the remote branch into yours)nothing to commit, working tree clean<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>git statusçœ‹åˆ°åŠŸèƒ½åˆ†æ”¯feature-xxxæœ‰è½åï¼Œè¿™æ—¶å€™éœ€è¦æ‹‰å–è½åçš„ä»£ç åˆ°æœ¬åœ°</p><p>æ³¨æ„è¿™é‡Œä¸è¦ç›´æ¥ä½¿ç”¨git pull ï¼Œgit pull å…¶å®ä¼šåšä¸¤ä¸ªäº‹æƒ… git fetch + git merge , ä¼šäº§ç”Ÿgitæäº¤è®°å½•çš„ç¯çº¿ï¼Œè¿™æ˜¯æˆ‘ä»¬è¦é¿å…äº§ç”Ÿçš„äº‹æƒ…ã€‚</p><p><strong>è¯·ä½¿ç”¨git pull â€“rebase</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git pull --rebaseerror: could not apply 49f99fb... lisi commit allResolve all conflicts manually, mark them as resolved with&quot;git add&#x2F;rm &lt;conflicted_files&gt;&quot;, then run &quot;git rebase --continue&quot;.You can instead skip this commit: run &quot;git rebase --skip&quot;.To abort and get back to the state before &quot;git rebase&quot;, run &quot;git rebase --abort&quot;.Could not apply 49f99fb... lisi commit allAuto-merging src&#x2F;main&#x2F;java&#x2F;com&#x2F;example&#x2F;leetcode&#x2F;editor&#x2F;test&#x2F;Test.javaCONFLICT (content): Merge conflict in src&#x2F;main&#x2F;java&#x2F;com&#x2F;example&#x2F;leetcode&#x2F;editor&#x2F;test&#x2F;Test.java<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°å‡ºç°äº†å†²çªï¼ˆCONFLICTï¼‰ï¼Œè¿™æ—¶å€™éœ€è¦åˆ°ideaä¸­å¤„ç†å†²çª</p><img src="/2022/030854417/git-rebase-lisi-fix2.gif" class="" title="å›¾ç‰‡å¼•ç”¨æ–¹æ³•ä¸€"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ git statusOn branch feature-xxxYour branch is ahead of &#39;origin&#x2F;feature-xxx&#39; by 1 commit.  (use &quot;git push&quot; to publish your local commits)nothing to commit, working tree clean$ git push<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="rebaseå¸¸è§é—®é¢˜"><a href="#rebaseå¸¸è§é—®é¢˜" class="headerlink" title="rebaseå¸¸è§é—®é¢˜"></a>rebaseå¸¸è§é—®é¢˜</h2><h3 id="1-ä½œä¸ºä¸€ä¸ªfeatureè´Ÿè´£äººï¼Œå‘ç°è½åreleaseåˆ†æ”¯å¤ªå¤šäº†æ€ä¹ˆåŠ"><a href="#1-ä½œä¸ºä¸€ä¸ªfeatureè´Ÿè´£äººï¼Œå‘ç°è½åreleaseåˆ†æ”¯å¤ªå¤šäº†æ€ä¹ˆåŠ" class="headerlink" title="1.ä½œä¸ºä¸€ä¸ªfeatureè´Ÿè´£äººï¼Œå‘ç°è½åreleaseåˆ†æ”¯å¤ªå¤šäº†æ€ä¹ˆåŠ"></a>1.ä½œä¸ºä¸€ä¸ªfeatureè´Ÿè´£äººï¼Œå‘ç°è½åreleaseåˆ†æ”¯å¤ªå¤šäº†æ€ä¹ˆåŠ</h3><p>å‡ºç°è¿™ç§æƒ…å†µæœ‰ä¸¤ç§åŸå› ï¼š</p><ul><li>featureåˆ†æ”¯å¤ªä¹…æ²¡æœ‰å…³æ³¨releaseåˆ†æ”¯çš„çŠ¶æ€ï¼Œå¯¼è‡´è½åreleaseåˆ†æ”¯å¤ªå¤š</li><li>releaseåˆ†æ”¯è¢«äººæ— è„‘æäº¤ï¼Œæ²¡æœ‰å‹ç‚¹</li></ul><p>ç¬¬äºŒç§æƒ…å†µæ˜¯è¦<strong>æåŠ›é¿å…</strong>çš„ï¼Œè¿™ç§ä¸è´Ÿè´£ä»»çš„æäº¤å¾ˆå¯èƒ½å¯¼è‡´å„ä¸ªfeatureåˆ†æ”¯åç»­çš„rebaseæäº¤éœ€è¦è§£å†³å¤šæ¬¡å†²çª</p><p>ç¬¬ä¸€ç§æƒ…å†µæ€ä¹ˆè§£å†³ï¼š</p><ul><li>å…ˆå°è¯•ç›´æ¥rebase releaseï¼Œå¦‚æœæ²¡æœ‰å†²çªæˆ–è€…åªéœ€è¦è§£å†³ä¸€ä¸¤æ¬¡å†²çªï¼Œé‚£ä¹ˆå°±é‡‡ç”¨ç›´æ¥rebaseçš„æ–¹å¼ã€‚</li><li>å¦‚æœrebase releaseæ–¹å¼æœ‰å†²çªçš„ç‚¹å¾ˆå¤šï¼Œé‚£ä¹ˆå¯ä»¥é‡‡ç”¨å°†featureåˆ†æ”¯å‹ç‚¹ç„¶ååˆ‡æ¢åˆ°releaseåˆ†æ”¯ä½¿ç”¨cherry-pickçš„æ–¹å¼åšä»£ç åˆå¹¶ï¼Œç„¶åé‡æ–°åˆ›å»ºfeatureåˆ†æ”¯ï¼Œæˆ–è€…set-up-streamé‡æ–°æŒ‡å‘è¿œç¨‹featureåˆ†æ”¯ã€‚</li></ul><h3 id="2-æœ‰äººæŠŠå¼€å‘ä¸»å¹²åˆ†æ”¯å‹ç‚¹ç„¶åå¼ºæ¨äº†æ€ä¹ˆåŠ"><a href="#2-æœ‰äººæŠŠå¼€å‘ä¸»å¹²åˆ†æ”¯å‹ç‚¹ç„¶åå¼ºæ¨äº†æ€ä¹ˆåŠ" class="headerlink" title="2.æœ‰äººæŠŠå¼€å‘ä¸»å¹²åˆ†æ”¯å‹ç‚¹ç„¶åå¼ºæ¨äº†æ€ä¹ˆåŠ"></a>2.æœ‰äººæŠŠå¼€å‘ä¸»å¹²åˆ†æ”¯å‹ç‚¹ç„¶åå¼ºæ¨äº†æ€ä¹ˆåŠ</h3><p><em><strong>æ³¨æ„ï¼šä½¿ç”¨rebaseçš„æ–¹å¼ï¼Œå¦‚æœåˆ†æ”¯æ˜¯ä¸ªå…¬å…±åˆ†æ”¯ï¼Œé‚£ä¹ˆä¸å…è®¸rebaseï¼Œè¿™ä¼šæ‰“ä¹±åˆ«äººæœ¬åœ°ä»“åº“çš„gitæäº¤çº¿</strong></em></p><h2 id="commit-msgè§„èŒƒ"><a href="#commit-msgè§„èŒƒ" class="headerlink" title="commit msgè§„èŒƒ"></a>commit msgè§„èŒƒ</h2><ul><li>featï¼šæ–°åŠŸèƒ½ï¼ˆfeatureï¼‰</li><li>fixï¼šbugä¿®å¤</li><li>refactorï¼šé‡æ„</li><li>testï¼šè¡¥å……å•å…ƒæµ‹è¯•</li><li>docsï¼šè¡¥å……æ–‡æ¡£</li><li>styleï¼šæ ·å¼/æ ¼å¼ï¼Œä¸å½±å“ä¸šåŠ¡ä»£ç  or é€»è¾‘</li></ul><p>æäº¤æè¿°çš„æ—¶å€™ï¼Œå¦‚æœæ¶‰åŠå¤šä¸ªå†…å®¹ï¼Œåˆ™ä½¿ç”¨1.2.3åšæ ‡æ³¨</p><ol><li>åšäº†ä»€ä¹ˆ</li><li>åšäº†ä»€ä¹ˆ</li><li>åšäº†ä»€ä¹ˆ</li></ol><h2 id="ä¸€å®šè¦æ³¨æ„çš„äº‹æƒ…"><a href="#ä¸€å®šè¦æ³¨æ„çš„äº‹æƒ…" class="headerlink" title="ä¸€å®šè¦æ³¨æ„çš„äº‹æƒ…"></a>ä¸€å®šè¦æ³¨æ„çš„äº‹æƒ…</h2><ul><li>åšä»»ä½•æ“ä½œçš„<strong>å‰å</strong>éƒ½<strong>ä¸€å®š</strong>è¦ git  statusæŸ¥çœ‹å·¥ä½œåŒºçŠ¶æ€</li><li>è‡ªå·±çš„åˆ†æ”¯å¯ä»¥git push -f ï¼Œä½†æ˜¯<strong>å…¬å…±åˆ†æ”¯ï¼Œä¸€å®šä¸è¦è¿™ä¹ˆåšï¼</strong></li><li>ä¸è¦å¯¹å…¬å…±åˆ†æ”¯åšå‹ç‚¹æ“ä½œï¼Œ<strong>æ°¸è¿œä¸è¦ï¼</strong></li><li>ä½¿ç”¨git pull â€“rebase <strong>ä¸€å®š</strong>æ˜¯æ­£ç¡®çš„ã€‚å°½é‡ä¸è¦ä½¿ç”¨git pullï¼Œä¸€æœ‰å†²çªå°±ä¼šmerge</li></ul>]]></content>
      
      
      <categories>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
